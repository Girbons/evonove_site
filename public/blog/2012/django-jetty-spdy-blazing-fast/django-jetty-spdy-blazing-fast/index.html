 

<head>

        
        <title>Django &#43; Jetty &#43; SPDY = blazing fast!!!</title>
        <meta name="keywords" content="" />
        <meta name="description" content="" />
        <meta name="author" content="evonove" />
        <meta name="robots" content="follow, index" />
        
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        
        <link rel="stylesheet" href="http://localhost:1313/rs-plugin/css/settings.css" media="screen">
        <link rel="stylesheet" href="http://localhost:1313/css/rs-responsive.min.css" media="screen">
        
        <link rel="stylesheet" href="http://localhost:1313/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://localhost:1313/css/custom.min.css">
        <link rel="stylesheet" href="http://localhost:1313/css/isotope.min.css">
        <link rel="stylesheet" href="http://localhost:1313/css/color_scheme.min.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic,700,700italic" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="http://localhost:1313/css/font-awesome.min.css">
        <link rel="stylesheet" href="http://localhost:1313/css/font-awesome-ie7.min.css">
        <link rel="stylesheet" href="http://localhost:1313/css/flexslider.min.css">
        <link rel="stylesheet" href="http://localhost:1313/css/jquery.fancybox.min.css?v=2.1.0" type="text/css" media="screen">
        
        <link rel="stylesheet" type="text/css" href="http://localhost:1313/css/IE-fix.css">

        <link rel="icon" type="image/png" href="http://localhost:1313/img/favicon.ico">

    <meta name="description" content="Say Hello to Evonove!
=====================

IT co..." />
    <meta name="keywords" content="" />

    </head>

<body>
 <header>
<div class="top_line"></div>

            <div class="container">
                <div class="row">
                    
                    <div class="span4 logo">
                        <a class="logo" href="/">
                            <img alt="logo" title="bizstrap" src="/img/logo.png">
                        </a>
                    </div>

                    
                    <div class="span4 offset4">
                        <p class="head_phone"><a href="tel:+39-075-843667"><i class="icon-phone"></i>&nbsp; (+39) 075 843667</a></p>
                    </div>

                    
                    <div class="span pull-right">
                        <div class="span3 pull-right">
                            <ul class="socials unstyled">
                                <li><a class="flickr" href="http://www.flickr.com/photos/evonovesrl/"></a></li>
                                <li><a class="twitter" href="https://twitter.com/evonove"></a></li>
                                <li><a class="facebook" href="https://www.facebook.com/evonovesrl"></a></li>
                                <li><a class="linkedin" href="http://www.linkedin.com/company/evonove"></a></li>
                                <li><a class="vimeo" href="http://vimeo.com/user11262087"></a></li>
                                <li><a class="gplus" href="https://plus.google.com/111644060204650622285/"></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            
            <div class="container">
                <div class="navbar">
                    <div class="navbar-inner">
                        <div class="container">
                            <div class="buttons-container">
                            </div>
                            <div class="nav-collapse">
                                <ul class="nav nav-pills">
                                    <li class="single active">
                                        <a href="/">
                                            HOME<i>127.0.0.1</i>
                                        </a>
                                    </li>
                                    <li class="dropdown">
                                        <a class="dropdown-toggle" data-toggle="dropdown" href="#menu1">
                                            ACTIVITIES<i>what we do</i>
                                        </a>
                                        <ul class="dropdown-menu">
                                            
                                            <li><a href="/activities/consulting/">Consulting</a></li>
                                            
                                            <li><a href="/activities/software/">Software</a></li>
                                            
                                            <li><a href="/activities/workshop/">Workshop</a></li>
                                            
                                        </ul>
                                    </li>

                                    <li class="dropdown">

                                        <a class="dropdown-toggle" data-toggle="dropdown" href="#menu1">
                                            EXPERTISE<i>what we can do</i>
                                        </a>


                                        <ul class="dropdown-menu">
                                            
                                            <li><a href="/expertise/molecular-visualization/">Molecular Visualization</a></li>
                                            
                                            <li><a href="/expertise/qt/">Qt</a></li>
                                            
                                            <li><a href="/expertise/django/">Django</a></li>
                                            
                                            <li><a href="/expertise/videomapping/">Videomapping</a></li>
                                            
                                            <li><a href="/expertise/webapps/">Rich Web Applications</a></li>
                                            
                                        </ul>

                                    </li>


                                    <li class="single">
                                        <a class="single" href="/blog/">
                                            BLOG<i>e9 techies</i>
                                        </a>
                                    </li>
                                    <li class="single">
                                        <a class="single" href="/staff/">
                                            STAFF<i>about us</i>
                                        </a>
                                    </li>


                                    <li class="single">
                                        <a href="/contacts/">
                                            CONTACTS<i>get in touch</i>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
</header>


    <div class="content container">
<div class="post">
  <h1>Django &#43; Jetty &#43; SPDY = blazing fast!!!</h1>
      

<p>During November, 2009 a new open network protocol named SPDY was defined with a
first draft; the main goal of this new protocol was reducing the latency during
web pages loading. The achievement of the technical specifications must comply
with certain requirements: minimize deployment complexity; avoid the need of any
changes to content by website developers so that the only changes required to
support SPDY are in the client user agent or in the web server application.</p>

<h2 id="toc_0">Who supports SPDY</h2>

<p>Recently IETF HTTP-bis working group has announced that the first draft of
HTTP 2.0 is based on SPDY protocol drafts. During the evolution of SPDY many of
most famous web servers implement, as experimental feature, this new protocol.
Just to name a few, we are talking about Jetty, Apache (via mod_spdy), node.js
and nginx.</p>

<h2 id="toc_1">Why Python web framework cannot support SPDY natively?</h2>

<p>PEP-333 defines WSGI specification as a standard interface between the web
server side and the application / framework side for Python web development.
WSGI doesn’t support SPDY natively so the protocol cannot be used with Python
web frameworks like Django.</p>

<h2 id="toc_2">Django and Jython: prepare for Jetty</h2>

<p>While waiting for an evolution of the current WSGI implementation, it is still
possibile to set up some technologies in order to serve a Django application
with Jetty as web container in order to take advantage of Jetty SPDY and SPDY
push support. To achieve this goal it’s necessary to use Jython, a Java
implementation of Python language. Steps below define how to configure a Django
instance inside Jetty with SPDY push feature enabled.</p>

<p>Download and install the stable version of Jython (currently 2.5.3).
Even if it’s possible to create and develop the Django application using a
traditional Python virtualenv, you need to create a new virtualenv with Jython
interpreter during deployment phase.</p>

<p>The use of Django ORM is a common problem that need to be solved in order to
run Django inside Jython. This is caused by database backends that depend on
libraries written in C language.
To overcome this it’s necessary to install django-jython module so it is
possible to use some useful tool together with all zxJDBC backends.
Unfortunately the currently released version of module (1.3.0) doesn’t have a
working support for Django 1.4. However it’s possibile to use the latest
available version in the official repository
(actually use changeset e2c6ff29cd01) that include some bug fixes and a good
Django support.</p>

<p>To enable django-jython module it’s necessary to edit database backends and
Django INSTALLED_APPS:</p>

<pre><code>DATABASES = {
    'default': {
    'ENGINE': 'doj.backends.zxjdbc.postgresql',
    [...]
    }
}

INSTALLED_APPS = (
    [...]
    'doj',
)
</code></pre>

<p>This will enable some extra features like the capability to create a war package
directly from manage.py within Jython, the Django framework, the desired JDBC
driver (an include java lib parameter should be used) and the developed
application.</p>

<h2 id="toc_3">Deploy Django on Jetty</h2>

<p>Jetty version 8.1.8.v20121106 stable was used in this setup. Without any
further configuration it is possible to deploy the war package as usual to have
Django up and running.</p>

<h2 id="toc_4">Django, Jetty and SPDY</h2>

<p>To serve a web page with SPDY protocol it’s necessary to add ‘spdy’ in OPTIONS
parameter inside start.ini file. Then jetty-spdy.xml configuration file should
be used. As defined by SPDY protocol if SPDY over HTTPS (TLS) is used, the Next
Procol Negotiation (NPN) library is required. The JVM should be started with
non-standard option:</p>

<pre><code>java -Xbootclasspath/p:&lt;path_to_npn_boot_jar&gt;
</code></pre>

<p>Version of library in use is npn-boot-8.1.2.v20120308.jar. At this point Jetty
can serve your application with SPDY support.</p>

<h2 id="toc_5">Django, Jetty, SPDY. Time to PUSH!</h2>

<p>Thanks to Jetty and its SPDY implementation it is possible to use server push
to reduce the number of client requests.
To enable transparent push feature a pushStrategy should be activated inside
Jetty configuration file. To improve the behaviour of a push strategy two
variables must be set:</p>

<pre><code>&lt;Set name=&quot;referrerPushPeriod&quot;&gt;15000&lt;/Set&gt;
</code></pre>

<p>define a delay after which Jetty will stop to load in push mode associated
resources of a main request;</p>

<pre><code>&lt;Set name=&quot;maxAssociatedResources&quot;&gt;32&lt;/Set&gt;
</code></pre>

<p>define the maximum associated resources of a main request that can be pushed.
Over this cap the remaining resources are sent using SPDY without push.
After this configuration Django will be served using SPDY-PUSH feature.</p>

<h2 id="toc_6">To sum up!</h2>

<p>Even if this view is optimized to emphasize SPDY potentiality, below we list
the average load time of this Django page served by Jetty:</p>

<ul>
<li>HTTP (1.1): <strong>7,63 seconds</strong></li>
<li>SPDY/3: <strong>1,71 seconds</strong></li>
<li>SPDY/3 (with push): <strong>1,55 seconds</strong></li>
</ul>

<p>Collected values refer to a preliminary test run locally with a 200ms round
trip delay and it isn&rsquo;t a benchmark of real use cases.</p>

<h2 id="toc_7">Source code</h2>

<p>Project code, war package and Jetty configuration: <a href="https://bitbucket.org/evonove/django-spdy/">https://bitbucket.org/evonove/django-spdy/</a></p>

<p>References</p>

<ul>
<li><a href="http://webtide.intalio.com/">http://webtide.intalio.com/</a></li>
<li><a href="http://wiki.eclipse.org/Jetty">http://wiki.eclipse.org/Jetty</a></li>
<li><a href="http://chromium.org/spdy">http://chromium.org/spdy</a></li>
<li><a href="http://djangoproject.org">http://djangoproject.org</a></li>
<li><a href="http://packages.python.org/django-jython/">http://packages.python.org/django-jython/</a></li>
<li><a href="http://code.google.com/p/mod-spdy/">http://code.google.com/p/mod-spdy/</a></li>
</ul>

</div>
</div> 
 <footer id="footer">


            <div class="footer-top"></div>
            <div class="footer-wrapper">
                <div class="container">
                    <div class="row show-grid">
                        <div class="span12">
                            <div class="row show-grid">
                                
                                <div class="span4">
                                    <img alt="" class="footer-logo" src="/img/grey_logo.png" />
                                    
                                    <address class="address">
                                        <p><i class="icon-map-marker icon-large"></i>via Fra' Filippo Longo 16</p>
                                        <p><i>&nbsp;</i>06063 - Magione (PG)</p>
                                        <p><i class="icon-phone icon-large"></i>Phone: (+39) 075 843667</p>
                                        <p><i class="icon-print icon-large"></i>Fax: (+39) 075 843667</p>
                                    </address>
                                </div>
                                
                                <div class="span4 footer-center">
                                    <h5 class="center-title">About E9</h5>
<dl class="dl-horizontal">
    <dt>Sector</dt>
    <dd>Software and IT Infrastructures.</dd>
    <dt>Services</dt>
    <dd>Software development, consultancy, formation, coworking, workshops, internships</dd>
</dl>
                                </div>
                                
                                <div class="span4 footer-right">
                                    <h4 class="center-title">Links</h4>
<ul class="footer-navigate">
    <li><a href="/">Home</a></li>
    <li><a href="https://github.com/evonove">Evonove on GitHub</a></li>
    <li><a href="http://wiki.evonove.it">EvoWiki</a></li>
    <li><a href="http://tofu.st">Tofu</a></li>
    <li><a href="/contacts/">Contact</a></li>
</ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="container">
                    <div class="row show-grid">
                        
                        <div class="span12">
                            <p>
                                Built with <a href="https://github.com/posativ/acrylamid">Acrylamid</a> v.0.7.7
                                - Copyright 2014 Evonove SRL - P.I. IT03120810548
                                - Source Code: <a href="https://github.com/evonove/evonove.it/commit/07ff32c27c0f42e9ead7cb862cdf6556f9613ce3">07ff32c</a>
                                - Found a bug? <a href="https://github.com/evonove/evonove.it/issues">Report an issue</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>


        </footer>

         

        <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.0.3/jquery-2.0.3.min.js"></script>
        <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.migrate/1.2.1/jquery-migrate.min.js"></script>
        <script  type="text/javascript" src="http://localhost:1313/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="http://localhost:1313/js/jquery.flexslider-min.js"></script>
        <script type="text/javascript" src="http://localhost:1313/js/jquery.isotope.min.js"></script>
        <script type="text/javascript" src="http://localhost:1313/rs-plugin/js/jquery.themepunch.plugins.min.js"></script>
        <script type="text/javascript" src="http://localhost:1313/rs-plugin/js/jquery.themepunch.revolution.min.js"></script>
	    <script type="text/javascript" src="http://localhost:1313/js/revolution.custom.min.js"></script>
	    <script type="text/javascript" src="http://localhost:1313/js/custom.min.js"></script>
        <script>
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-19911362-1']);
            _gaq.push(['_trackPageview']);

            (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>


  <script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>
